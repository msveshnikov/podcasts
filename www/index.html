<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <title>PodWave - Your Enhanced Podcast Player</title>
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            body {
                font-family: "Poppins", sans-serif;
                background-color: #0f3460;
                color: #e94560;
                padding-bottom: 80px;
            }
            .header {
                background-color: #16213e;
                padding: 20px;
                text-align: center;
                position: sticky;
                top: 0;
                z-index: 1000;
            }
            .app-title {
                font-size: 2rem;
                margin-bottom: 10px;
            }
            .search-container {
                display: flex;
                justify-content: center;
                align-items: center;
                margin-top: 10px;
            }
            #searchInput {
                padding: 10px;
                width: 70%;
                border: none;
                border-radius: 20px;
                font-size: 1rem;
            }
            #subscribeBtn {
                padding: 10px 20px;
                margin-left: 10px;
                background-color: #e94560;
                color: #fff;
                border: none;
                border-radius: 20px;
                cursor: pointer;
                font-size: 1rem;
            }
            .tabs {
                display: flex;
                justify-content: center;
                margin-top: 20px;
            }
            .tab {
                padding: 10px 20px;
                margin: 0 5px;
                background-color: #16213e;
                color: #fff;
                border: none;
                border-radius: 20px;
                cursor: pointer;
                font-size: 1rem;
            }
            .tab.active {
                background-color: #e94560;
            }
            .podcast-list {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                gap: 20px;
                padding: 20px;
            }
            .podcast-item {
                background-color: #16213e;
                border-radius: 12px;
                overflow: hidden;
                position: relative;
                cursor: pointer;
                transition: transform 0.3s ease;
            }
            .podcast-item:hover {
                transform: translateY(-5px);
            }
            .podcast-image {
                width: 100%;
                height: 200px;
                object-fit: cover;
            }
            .podcast-content {
                padding: 15px;
            }
            .podcast-title {
                font-size: 1.2rem;
                font-weight: 600;
                margin-bottom: 5px;
            }
            .podcast-author {
                font-size: 0.9rem;
                color: #a9a9a9;
                margin-bottom: 10px;
            }
            .podcast-description {
                font-size: 0.9rem;
                color: #fff;
            }
            .favorite-btn {
                position: absolute;
                top: 10px;
                right: 10px;
                background: none;
                border: none;
                font-size: 1.5rem;
                cursor: pointer;
            }
            .player {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background-color: #16213e;
                display: none;
                align-items: center;
                padding: 10px;
                height: 80px;
            }
            .player-image {
                width: 60px;
                height: 60px;
                border-radius: 5px;
                margin-right: 15px;
            }
            .player-info {
                flex-grow: 1;
            }
            .player-title {
                font-weight: 600;
                margin-bottom: 5px;
            }
            .player-author {
                font-size: 0.8rem;
                color: #a9a9a9;
            }
            .player-controls {
                display: flex;
                align-items: center;
            }
            .player-btn {
                background: none;
                border: none;
                font-size: 1.5rem;
                margin: 0 10px;
                cursor: pointer;
                color: #e94560;
            }
            .modal {
                display: none;
                position: fixed;
                z-index: 1001;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                overflow: auto;
                background-color: rgba(0, 0, 0, 0.4);
            }
            .modal-content {
                background-color: #16213e;
                margin: 15% auto;
                padding: 20px;
                border: 1px solid #888;
                width: 80%;
                max-width: 500px;
                border-radius: 12px;
            }
            .close {
                color: #aaa;
                float: right;
                font-size: 28px;
                font-weight: bold;
                cursor: pointer;
            }
            .close:hover,
            .close:focus {
                color: #e94560;
                text-decoration: none;
                cursor: pointer;
            }
            #feedUrl {
                width: 100%;
                padding: 10px;
                margin: 10px 0;
                border: none;
                border-radius: 5px;
            }
            #addFeedBtn {
                width: 100%;
                padding: 10px;
                background-color: #e94560;
                color: #fff;
                border: none;
                border-radius: 5px;
                cursor: pointer;
            }
            .episode-list {
                display: none;
                background-color: #0f3460;
                padding: 10px;
                border-radius: 0 0 12px 12px;
            }
            .episode-item {
                padding: 10px;
                border-bottom: 1px solid #16213e;
                cursor: pointer;
            }
            .episode-item:last-child {
                border-bottom: none;
            }
            .episode-title {
                font-weight: bold;
                color: #e94560;
            }
            .episode-date {
                font-size: 0.8rem;
                color: #a9a9a9;
            }
        </style>
    </head>
    <body>
        <div class="header">
            <h1 class="app-title">PodWave</h1>
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="Search podcasts..." />
                <button id="subscribeBtn">Subscribe</button>
            </div>
            <div class="tabs">
                <button class="tab active" data-tab="trending">Trending</button>
                <button class="tab" data-tab="favorites">Favorites</button>
                <button class="tab" data-tab="subscriptions">Subscriptions</button>
            </div>
        </div>

        <div id="podcastList" class="podcast-list"></div>

        <div id="player" class="player">
            <img id="playerImage" class="player-image" src="" alt="Podcast Cover" />
            <div class="player-info">
                <div id="playerTitle" class="player-title"></div>
                <div id="playerAuthor" class="player-author"></div>
            </div>
            <div class="player-controls">
                <button id="prevButton" class="player-btn">⏮️</button>
                <button id="playPauseButton" class="player-btn">▶️</button>
                <button id="nextButton" class="player-btn">⏭️</button>
            </div>
        </div>

        <audio id="audioPlayer"></audio>

        <div id="subscribeModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Subscribe to Podcast</h2>
                <input type="text" id="feedUrl" placeholder="Enter RSS feed URL" />
                <button id="addFeedBtn">Add Feed</button>
            </div>
        </div>

        <script>
            const podcastData = [
                {
                    id: 1,
                    title: "Tech Talk",
                    author: "John Doe",
                    description: "Latest in technology and gadgets",
                    image: "https://via.placeholder.com/300x300.png?text=Tech+Talk",
                    audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3",
                },
                {
                    id: 2,
                    title: "Science Hour",
                    author: "Jane Smith",
                    description: "Exploring the wonders of science",
                    image: "https://via.placeholder.com/300x300.png?text=Science+Hour",
                    audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3",
                },
                {
                    id: 3,
                    title: "History Uncovered",
                    author: "Mike Johnson",
                    description: "Revealing hidden stories from the past",
                    image: "https://via.placeholder.com/300x300.png?text=History+Uncovered",
                    audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3",
                },
                {
                    id: 4,
                    title: "Fitness Fanatics",
                    author: "Sarah Lee",
                    description: "Tips and tricks for a healthier lifestyle",
                    image: "https://via.placeholder.com/300x300.png?text=Fitness+Fanatics",
                    audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3",
                },
                {
                    id: 5,
                    title: "Movie Madness",
                    author: "Chris Evans",
                    description: "Reviews and discussions on the latest films",
                    image: "https://via.placeholder.com/300x300.png?text=Movie+Madness",
                    audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3",
                },
            ];

            let currentPodcast = null;
            let isPlaying = false;
            let favorites = JSON.parse(localStorage.getItem("favorites")) || [];
            let subscriptions = JSON.parse(localStorage.getItem("subscriptions")) || [];
            let currentTab = "trending";

            const audioPlayer = document.getElementById("audioPlayer");
            const modal = document.getElementById("subscribeModal");
            const subscribeBtn = document.getElementById("subscribeBtn");
            const closeBtn = document.getElementsByClassName("close")[0];
            const addFeedBtn = document.getElementById("addFeedBtn");

            function createPodcastItem(podcast) {
                const isFavorite = favorites.includes(podcast.id);
                let episodeListHTML = "";
                if (podcast.episodes) {
                    episodeListHTML = `
                    <div class="episode-list">
                        ${podcast.episodes
                            .map(
                                (episode) => `
                            <div class="episode-item" data-audio="${episode.audio}">
                                <div class="episode-title">${episode.title}</div>
                                <div class="episode-date">${new Date(episode.pubDate).toLocaleDateString()}</div>
                            </div>
                        `
                            )
                            .join("")}
                    </div>
                `;
                }
                return `
                <div class="podcast-item" data-id="${podcast.id}">
                    <img src="${podcast.image}" alt="${podcast.title}" class="podcast-image">
                    <button class="favorite-btn" onclick="toggleFavorite(${podcast.id}, event)">${
                    isFavorite ? "❤️" : "🤍"
                }</button>
                    <div class="podcast-content">
                        <div class="podcast-title">${podcast.title}</div>
                        <div class="podcast-author">${podcast.author}</div>
                        <div class="podcast-description">${podcast.description}</div>
                    </div>
                    ${episodeListHTML}
                </div>
            `;
            }

            function renderPodcasts() {
                const podcastList = document.getElementById("podcastList");
                let podcasts;

                if (currentTab === "trending") {
                    podcasts = podcastData;
                } else if (currentTab === "favorites") {
                    podcasts = podcastData.filter((podcast) => favorites.includes(podcast.id));
                } else if (currentTab === "subscriptions") {
                    podcasts = subscriptions;
                }

                podcastList.innerHTML = podcasts.map(createPodcastItem).join("");

                podcastList.querySelectorAll(".podcast-item").forEach((item) => {
                    item.addEventListener("click", (e) => {
                        if (!e.target.classList.contains("favorite-btn") && !e.target.closest(".episode-item")) {
                            const episodeList = item.querySelector(".episode-list");
                            if (episodeList) {
                                episodeList.style.display = episodeList.style.display === "none" ? "block" : "none";
                            } else {
                                const podcastId = parseInt(item.getAttribute("data-id"));
                                playPodcast(podcastId);
                            }
                        }
                    });
                });

                podcastList.querySelectorAll(".episode-item").forEach((episode) => {
                    episode.addEventListener("click", (e) => {
                        e.stopPropagation();
                        const audioUrl = episode.getAttribute("data-audio");
                        const podcastItem = episode.closest(".podcast-item");
                        const podcastId = parseInt(podcastItem.getAttribute("data-id"));
                        const podcast = subscriptions.find((p) => p.id === podcastId);
                        playEpisode(podcast, episode.querySelector(".episode-title").textContent, audioUrl);
                    });
                });
            }

            function toggleFavorite(id, event) {
                event.stopPropagation();
                const index = favorites.indexOf(id);
                if (index > -1) {
                    favorites.splice(index, 1);
                } else {
                    favorites.push(id);
                }
                localStorage.setItem("favorites", JSON.stringify(favorites));
                renderPodcasts();
            }

            function playPodcast(id) {
                currentPodcast =
                    podcastData.find((podcast) => podcast.id === id) ||
                    subscriptions.find((podcast) => podcast.id === id);
                document.getElementById("playerImage").src = currentPodcast.image;
                document.getElementById("playerTitle").textContent = currentPodcast.title;
                document.getElementById("playerAuthor").textContent = currentPodcast.author;
                document.getElementById("player").style.display = "flex";
                audioPlayer.src = currentPodcast.audio;
                togglePlayPause();
            }

            function playEpisode(podcast, episodeTitle, audioUrl) {
                currentPodcast = podcast;
                document.getElementById("playerImage").src = podcast.image;
                document.getElementById("playerTitle").textContent = episodeTitle;
                document.getElementById("playerAuthor").textContent = podcast.author;
                document.getElementById("player").style.display = "flex";
                audioPlayer.src = audioUrl;
                togglePlayPause();
            }

            function togglePlayPause() {
                isPlaying = !isPlaying;
                const playPauseButton = document.getElementById("playPauseButton");
                if (isPlaying) {
                    audioPlayer.play();
                    playPauseButton.textContent = "⏸️";
                } else {
                    audioPlayer.pause();
                    playPauseButton.textContent = "▶️";
                }
            }

            function playNext() {
                const currentIndex = podcastData.findIndex((podcast) => podcast.id === currentPodcast.id);
                const nextIndex = (currentIndex + 1) % podcastData.length;
                playPodcast(podcastData[nextIndex].id);
            }

            function playPrevious() {
                const currentIndex = podcastData.findIndex((podcast) => podcast.id === currentPodcast.id);
                const previousIndex = (currentIndex - 1 + podcastData.length) % podcastData.length;
                playPodcast(podcastData[previousIndex].id);
            }

            document.getElementById("playPauseButton").addEventListener("click", togglePlayPause);
            document.getElementById("nextButton").addEventListener("click", playNext);
            document.getElementById("prevButton").addEventListener("click", playPrevious);

            document.getElementById("searchInput").addEventListener("input", (e) => {
                const searchTerm = e.target.value.toLowerCase();
                const filteredPodcasts = podcastData.filter(
                    (podcast) =>
                        podcast.title.toLowerCase().includes(searchTerm) ||
                        podcast.author.toLowerCase().includes(searchTerm) ||
                        podcast.description.toLowerCase().includes(searchTerm)
                );
                renderFilteredPodcasts(filteredPodcasts);
            });

            function renderFilteredPodcasts(filteredPodcasts) {
                const podcastList = document.getElementById("podcastList");
                podcastList.innerHTML = filteredPodcasts.map(createPodcastItem).join("");
            }

            document.querySelectorAll(".tab").forEach((tab) => {
                tab.addEventListener("click", (e) => {
                    document.querySelectorAll(".tab").forEach((t) => t.classList.remove("active"));
                    e.target.classList.add("active");
                    currentTab = e.target.getAttribute("data-tab");
                    renderPodcasts();
                });
            });

            subscribeBtn.onclick = function () {
                modal.style.display = "block";
            };

            closeBtn.onclick = function () {
                modal.style.display = "none";
            };

            window.onclick = function (event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                }
            };

            addFeedBtn.onclick = function () {
                const feedUrl = document.getElementById("feedUrl").value;
                if (feedUrl) {
                    fetchRssFeed(feedUrl);
                } else {
                    alert("Please enter a valid RSS feed URL");
                }
            };

            async function fetchRssFeed(url) {
                try {
                    const response = await fetch(
                        `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(url)}`
                    );
                    const data = await response.json();

                    if (data.status === "ok") {
                        const feedData = {
                            id: Date.now(), // Generate a unique ID
                            title: data.feed.title,
                            author: data.feed.author,
                            description: data.feed.description,
                            image: data.feed.image,
                            episodes: data.items.map((item) => ({
                                title: item.title,
                                pubDate: item.pubDate,
                                audio: item.enclosure?.link || "",
                            })),
                        };

                        subscriptions.push(feedData);
                        localStorage.setItem("subscriptions", JSON.stringify(subscriptions));
                        modal.style.display = "none";
                        renderPodcasts();
                    } else {
                        alert("Failed to fetch RSS feed. Please check the URL and try again.");
                    }
                } catch (error) {
                    console.error("Error fetching RSS feed:", error);
                    alert("An error occurred while fetching the RSS feed. Please try again.");
                }
            }

            renderPodcasts();
        </script>
    </body>
</html>
